<div class="password-container">
    <div class="password-panel">
        <!-- Header -->
        <div class="header-section">
            <a href="/landing" class="brand-container" style="text-decoration: none; color: inherit">
                <div class="brand-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" width="48" height="48">
                        <rect width="200" height="200" rx="32" ry="32" fill="#274690" />
                        <circle cx="42" cy="38" r="8" fill="#FFFFFF" opacity="0.4" />
                        <circle cx="100" cy="38" r="8" fill="#FFFFFF" opacity="0.4" />
                        <circle cx="158" cy="38" r="8" fill="#FFFFFF" opacity="0.4" />
                        <rect x="25" y="65" width="42" height="115" rx="8" ry="8" fill="#FFFFFF" />
                        <circle cx="46" cy="122" r="10" fill="#274690" />
                        <rect x="79" y="65" width="42" height="115" rx="8" ry="8" fill="#FFFFFF" />
                        <rect x="87" y="118" width="26" height="8" rx="4" ry="4" fill="#274690" />
                        <rect x="133" y="65" width="42" height="115" rx="8" ry="8" fill="#FFFFFF" />
                        <path d="M 143 120 L 151 130 L 165 110" stroke="#274690" stroke-width="6" stroke-linecap="round"
                            stroke-linejoin="round" fill="none" />
                    </svg>
                </div>
                <div class="brand-name">Taskeer</div>
            </a>
        </div>

        <!-- Contenido Principal -->
        <div class="content-section">
            <div class="password-wrapper">
                <div class="password-icon">
                    <i class="fas fa-lock-keyhole"></i>
                </div>

                <div class="password-header">
                    <h2>Nueva Contraseña</h2>
                    <p>Crea una contraseña segura para tu cuenta</p>
                </div>

                <div class="message error-message" *ngIf="errorMessage">
                    <i class="fas fa-exclamation-circle"></i>
                    {{ errorMessage }}
                </div>

                <form #passwordForm="ngForm" (ngSubmit)="onSubmit()">
                    <!-- Nueva Contraseña -->
                    <div class="form-group">
                        <label class="form-label">Nueva Contraseña</label>
                        <div class="password-wrapper">
                            <div class="input-wrapper">
                                <span class="input-icon">
                                    <i class="fas fa-lock"></i>
                                </span>
                                <input [type]="showPassword ? 'text' : 'password'" class="form-input"
                                    [(ngModel)]="nuevaPassword" name="nuevaPassword"
                                    placeholder="Ingresa tu nueva contraseña" required minlength="6"
                                    [disabled]="isLoading" autocomplete="new-password" />
                                <button type="button" class="toggle-password" (click)="togglePasswordVisibility()">
                                    <i [class]="showPassword ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Indicador de fortaleza -->
                        <div class="password-strength" *ngIf="nuevaPassword">
                            <div class="strength-bar">
                                <div class="strength-fill"
                                    [style.width]="passwordStrength.level === 'weak' ? '33%' : passwordStrength.level === 'medium' ? '66%' : '100%'"
                                    [style.background-color]="passwordStrength.color">
                                </div>
                            </div>
                            <span class="strength-text" [style.color]="passwordStrength.color">
                                {{ passwordStrength.text }}
                            </span>
                        </div>
                    </div>

                    <!-- Confirmar Contraseña -->
                    <div class="form-group">
                        <label class="form-label">Confirmar Contraseña</label>
                        <div class="password-wrapper">
                            <div class="input-wrapper">
                                <span class="input-icon">
                                    <i class="fas fa-lock"></i>
                                </span>
                                <input [type]="showConfirmPassword ? 'text' : 'password'" class="form-input"
                                    [class.input-error]="!passwordsMatch" [(ngModel)]="confirmarPassword"
                                    name="confirmarPassword" placeholder="Confirma tu nueva contraseña" required
                                    minlength="6" [disabled]="isLoading" autocomplete="new-password" />
                                <button type="button" class="toggle-password"
                                    (click)="toggleConfirmPasswordVisibility()">
                                    <i [class]="showConfirmPassword ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Mensaje de no coincidencia -->
                        <div class="validation-message" *ngIf="!passwordsMatch && confirmarPassword">
                            <i class="fas fa-exclamation-circle"></i>
                            Las contraseñas no coinciden
                        </div>

                        <!-- Mensaje de coincidencia -->
                        <div class="validation-message success"
                            *ngIf="passwordsMatch && confirmarPassword && nuevaPassword">
                            <i class="fas fa-circle-check"></i>
                            Las contraseñas coinciden
                        </div>
                    </div>

                    <!-- Recomendaciones -->
                    <div class="info-box">
                        <h4><i class="fas fa-shield-halved"></i> Recomendaciones</h4>
                        <ul>
                            <li>Usa al menos 6 caracteres</li>
                            <li>Combina mayúsculas y minúsculas</li>
                            <li>Incluye números y símbolos</li>
                        </ul>
                    </div>

                    <!-- Botón -->
                    <button type="submit" class="submit-btn"
                        [disabled]="!passwordForm.form.valid || !passwordsMatch || isLoading">
                        <i [class]="isLoading ? 'fas fa-spinner fa-spin' : 'fas fa-check-circle'"></i>
                        {{ isLoading ? 'Actualizando...' : 'Actualizar Contraseña' }}
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Panel Decorativo -->
    <div class="decorative-panel">
        <div class="decorative-content">
            <div class="decorative-icon">
                <i class="fas fa-shield-check"></i>
            </div>
            <h3>Casi Listo</h3>
            <p>
                Crea una contraseña segura y recupera el acceso completo a tu cuenta de Taskeer.
            </p>

            <div class="security-features">
                <div class="security-item">
                    <i class="fas fa-key"></i>
                    <span>Contraseña encriptada</span>
                </div>
                <div class="security-item">
                    <i class="fas fa-user-shield"></i>
                    <span>Cuenta protegida</span>
                </div>
                <div class="security-item">
                    <i class="fas fa-circle-check"></i>
                    <span>Acceso restaurado</span>
                </div>
            </div>
        </div>
    </div>
</div>